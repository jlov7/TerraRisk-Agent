{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://example.com/schemas/action_credential_v0.json",
  "title": "Action Credential",
  "description": "Schema for action-level provenance credentials signed per step.",
  "type": "object",
  "required": [
    "version",
    "id",
    "timestamp",
    "actor",
    "action",
    "artifacts",
    "claims",
    "signatures"
  ],
  "properties": {
    "version": {
      "type": "string",
      "enum": ["0.1.0"]
    },
    "id": {
      "type": "string",
      "description": "Unique identifier for the credential"
    },
    "timestamp": {
      "type": "string",
      "format": "date-time"
    },
    "actor": {
      "type": "object",
      "required": ["name", "role", "identity"],
      "properties": {
        "name": {"type": "string"},
        "role": {"type": "string"},
        "identity": {"type": "string"},
        "contact": {"type": "string"}
      }
    },
    "action": {
      "type": "object",
      "required": ["type", "inputs", "outputs", "source"],
      "properties": {
        "type": {"type": "string"},
        "inputs": {"type": "array", "items": {"type": "string"}},
        "outputs": {"type": "array", "items": {"type": "string"}},
        "parameters": {"type": "object", "additionalProperties": true},
        "source": {
          "type": "object",
          "required": ["system", "reference"],
          "properties": {
            "system": {"type": "string"},
            "reference": {"type": "string"},
            "mode": {"type": "string", "enum": ["cloud", "byo_bigquery", "offline"]}
          }
        }
      }
    },
    "artifacts": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["uri", "hash", "type"],
        "properties": {
          "uri": {"type": "string"},
          "hash": {"type": "string"},
          "type": {"type": "string"},
          "c2pa_manifest": {"type": "string"},
          "soft_binding": {"type": "string"}
        }
      }
    },
    "claims": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["name", "value"],
        "properties": {
          "name": {"type": "string"},
          "value": {},
          "confidence": {"type": "number"}
        }
      }
    },
    "signatures": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["type", "signature", "verification_method"],
        "properties": {
          "type": {"type": "string", "enum": ["sigstore", "c2pa", "in_toto"]},
          "signature": {"type": "string"},
          "verification_method": {"type": "string"},
          "rekor_entry": {"type": "string"},
          "oci_reference": {"type": "string"}
        }
      }
    },
    "trace": {
      "type": "object",
      "properties": {
        "trace_id": {"type": "string"},
        "span_id": {"type": "string"},
        "parent_span_id": {"type": "string"}
      }
    }
  }
}
